\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{mymacros}[2022/09/10 MyMacros package]

\newif\if@beamer
\@beamerfalse

\newif\if@redefine
\@redefinetrue

% If the beamer option is set, then this package can be used with beamer
% In particular, it does not load the enumitem package, which messes up with beamer
\DeclareOption{beamer}{\@beamertrue}

% If the noredefine option is set, then this package does not redefine existing commands
\DeclareOption{noredefine}{\@redefinefalse}

% Throws a warning for unused options
\DeclareOption*{\OptionNotUsed}

\ProcessOptions

% Makes it possible to use the comma as a decimal separator
\RequirePackage{icomma}

% Better enumerate, itemize and description environments
\if@beamer
\else
\RequirePackage[shortlabels]{enumitem}
\fi

% Provides the \url and \href commands
\RequirePackage{hyperref}

% Makes it possible to use colors
\RequirePackage{xcolor}

% Provides support for figure
\RequirePackage{graphicx}
\RequirePackage{float}

% AMS packages
\RequirePackage{amsmath}
\RequirePackage{amssymb}
\RequirePackage{amsthm}

% Mathtools for amsmath addons
\RequirePackage{mathtools}

% Cancelling terms in equation
\RequirePackage{cancel}

% Array package for the \newcolumntype command
\RequirePackage{array}

% Number a specific equation in a *-environment
\newcommand\numberthis{\addtocounter{equation}{1}\tag{\theequation}}

% Define the theorem environments
\theoremstyle{plain}
\newtheorem{theorem}{Theorem}[section]
\newtheorem{corollary}{Corollary}[theorem]
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{proposition}[theorem]{Proposition}

\theoremstyle{definition}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{example}[theorem]{Example}
\newtheorem*{claim}{Claim}

\theoremstyle{remark}
\newtheorem{remark}{Remark}[theorem]
\newtheorem*{note}{Note}

% Define common macros for math

\newcommand{\N}{\mathbb{N}}
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\Q}{\mathbb{Q}}
\newcommand{\R}{\mathbb{R}}
\let\C\undefined
\newcommand{\C}{\mathbb{C}}
\newcommand{\F}{\mathbb{F}}
\newcommand{\K}{\mathbb{K}}

\DeclareMathOperator{\E}{\mathbb{E}}
\DeclareMathOperator{\Var}{Var}
% \P is already defined to pilcrow, which we don't use
\if@redefine
\let\P\undefined
\DeclareMathOperator{\P}{\mathbb{P}}
\fi

\DeclareMathOperator*{\argmax}{arg\,max}
\DeclareMathOperator*{\argmin}{arg\,min}
\DeclareMathOperator*{\esssup}{ess\,sup}
\DeclareMathOperator*{\essinf}{ess\,inf}

\newcommand{\into}{\hookrightarrow}
\newcommand{\onto}{\twoheadrightarrow}

\DeclareMathOperator{\im}{im}
\DeclareMathOperator{\rank}{rank}
\DeclareMathOperator{\id}{id}
\DeclareMathOperator{\tr}{tr}
\DeclareMathOperator{\diag}{diag}
\DeclareMathOperator{\spn}{span}

\DeclareMathOperator{\multideg}{multideg}
\DeclareMathOperator{\ord}{ord}
\DeclareMathOperator{\chr}{char}
\DeclareMathOperator{\sgn}{sgn}
\DeclareMathOperator{\lcm}{lcm}
\DeclareMathOperator{\disc}{disc}
\DeclareMathOperator{\Nm}{Nm}
\DeclareMathOperator{\Tr}{Tr}

\if@redefine
\let\divsymbol\div
\let\div\undefined
\DeclareMathOperator{\div}{div}
\else
\newcommand{\divsymbol}{\div}
\fi

\DeclareMathOperator{\wt}{wt}
\DeclareMathOperator{\ev}{ev}

\DeclareMathOperator{\rem}{rem}
\DeclareMathOperator{\quo}{quo}

\DeclareMathOperator{\supp}{supp}
\DeclareMathOperator*{\esssupp}{ess\,supp}
\DeclareMathOperator{\res}{res}

\DeclareMathOperator{\Hom}{Hom}
\DeclareMathOperator{\Aut}{Aut}
\DeclareMathOperator{\End}{End}
\DeclareMathOperator{\Sym}{Sym}
\DeclareMathOperator{\Mat}{Mat}
\DeclareMathOperator{\Spec}{Spec}
\DeclareMathOperator{\Proj}{Proj}

\DeclareMathOperator{\GL}{GL}
\DeclareMathOperator{\SO}{SO}
\DeclareMathOperator{\SL}{SL}
\DeclareMathOperator{\Sp}{Sp}
\DeclareMathOperator{\Ad}{Ad}

% The \Re and \Im are already defined, but I do not like them
\if@redefine
\let\Re\undefined
\let\Im\undefined
\DeclareMathOperator{\Re}{Re}
\DeclareMathOperator{\Im}{Im}
\DeclareMathOperator{\Res}{Res}
\fi

\newcommand{\dd}{\,\mathrm{d}}

% Defines the columntypes L, C, R that includes the dollars
\newcolumntype{L}{>{$}l<{$}}
\newcolumntype{C}{>{$}c<{$}}
\newcolumntype{R}{>{$}r<{$}}

% The wide versions look a lot better from my testing
\if@redefine
\let\old@tilde\tilde
\let\old@hat\hat
\newcommand{\narrowtilde}{\old@tilde}
\newcommand{\narrowhat}{\old@hat}
\renewcommand{\tilde}{\widetilde}
\renewcommand{\hat}{\widehat}
\else
\newcommand{\narrowtilde}{\tilde}
\newcommand{\narrowhat}{\hat}
\fi

% Triple vertical bars. Copied from https://tex.stackexchange.com/a/54395
\newcommand{\lWert}{\left\vert\kern-0.25ex\left\vert\kern-0.25ex\left\vert}
\newcommand{\rWert}{\right\vert\kern-0.25ex\right\vert\kern-0.25ex\right\vert}